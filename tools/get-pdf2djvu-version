#!/bin/sh
printf '// Generated atomatically. Do not edit.\n'
pdf2djvu_version=`sed -n -e '1 s/.*(\([0-9.]*\)).*/\1/p' < doc/ChangeLog`
poppler_info="poppler `pkg-config --modversion poppler-splash`" || exit 1
djvulibre_info="DjVuLibre `pkg-config --modversion ddjvuapi`" || exit 1
gm_info="GraphicsMagick++ `pkg-config --silence-errors --modversion GraphicsMagick++`" || gm_info=''
info="$djvulibre_info, $poppler_info"
if [ -n "$gm_info" ]
then
  printf '#define HAVE_GRAPHICS_MAGICK 1\n'
  info="$info, $gm_info"
fi
printf 'static const char PDF2DJVU_VERSION[] = "pdf2djvu %s (%s)";\n' "$pdf2djvu_version" "$info" 
